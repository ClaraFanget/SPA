<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Software Performing Art</title>
    <link rel="stylesheet" href="css/style.css" />
    <!-- PyScript CSS -->
    <link
      rel="stylesheet"
      href="https://pyscript.net/releases/2024.3.1/core.css"
    />
    <!-- This script tag bootstraps PyScript -->
    <script
      type="module"
      src="https://pyscript.net/releases/2024.3.1/core.js"
    ></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.3/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.3/addons/p5.sound.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="art/Leandreisk/Artwork3/libraries/p5.speech.js"></script>
    <script src="art/Yogya/glass/libraries/rhill-voronoi-core.js"></script>
  </head>
  <body>
    <header>
      <div id="header-title">
        <h1 id="SPA-title">Software</h1>
        <h1 id="SPA-title">Performing</h1>
        <h1 id="SPA-title">Art</h1>
        <a href="#nav">Entrer</a>
      </div>
    </header>
    <main>
      <nav id="nav">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="pages/publications.html">Publications</a></li>
          <li><a href="pages/art-history.html">Art History</a></li>
          <li><a href="pages/contact.html">Contact</a></li>
          <li><a href="convert/html/test.html">Pandoc</a></li>
        </ul>
      </nav>
      <div id="art-container">
        <div id="cartel">
          <div id="artist-name-container"></div>
          <div id="button-container">
            <button id="code-button">
              <img
                id="button-icon"
                src="assets/svg/code.svg"
                alt="icon code"
                height="20px"
                width="20px"
              />
            </button>
          </div>
        </div>

        <div id="artwork-container"></div>
        <div id="artist-container">
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-date="2025"
            data-path="art/UnMoutonPerdu/clouds/sketch.js"
          >
            clouds
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/cubes/sketch.js"
          >
            cubes
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/physarum/sketch.js"
          >
            physarum
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/trees/sketch2.js"
          >
            trees
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/tunnel/sketch.js"
          >
            tunnels
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/colors-and-shapes/sketch.js"
          >
            colors and shape
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/deJong/sketch.js"
          >
            deJong
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/ink-mountains/sketch.js"
          >
            ink mountains
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/labyrinth/sketch.js"
          >
            labyrinth
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/random-walker/sketch.js"
          >
            random walker
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/squares001/sketch.js"
          >
            squares001
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/vera-molnar-tp/sketch.js"
          >
            vera-molnar
          </p>
          <p
            class="artwork"
            data-artist="Hugo Mouton"
            data-path="art/UnMoutonPerdu/wind/sketch.js"
          >
            wind
          </p>
          <p
            class="artwork"
            data-artist="Nadia González Fernández"
            data-path="art/Nadia/4_flow_field_with_letters.js"
          >
            flow field with letters
          </p>
          <!-- <p
            class="artwork"
            data-path="art/CestJeanEnGros/Mind Duplication/sketch3.js"
          >
            NOT WORKING mind duplication - Cest Jean En Gros
          </p> -->
          <p
            class="artwork"
            data-artist="Jean Barreto"
            data-path="art/CestJeanEnGros/Singularity/sketch6.js"
          >
            singularity
          </p>
          <p
            class="artwork"
            data-artist="Gabriel Beaudoin"
            data-path="art/GabrielBeaudoin/oeuvre_1/arrow2.js"
          >
            arrow
          </p>
          <p
            class="artwork"
            data-artist="Gabriel Beaudoin"
            data-path="art/GabrielBeaudoin/oeuvre_2/turing.js"
          >
            turing
          </p>
          <p
            class="artwork"
            data-artist="Houda Fatih"
            data-path="art/Houda/sketch1.js"
          >
            firework
          </p>
          <p
            class="artwork"
            data-artist="Leandreisk"
            data-path="art/Leandreisk/Artwork1/sketch.js"
          >
            artwork 1
          </p>
          <p
            class="artwork"
            data-artist="Leandreisk"
            data-path="art/Leandreisk/Artwork2/sketch.js"
          >
            artwork 2
          </p>
          <p
            class="artwork"
            data-artist="Leandreisk"
            data-path="art/Leandreisk/Artwork3/sketch.js"
          >
            artwork 3
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/genuary24/sketch.js"
          >
            genuary 24
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/hex_grid/sketch.js"
          >
            hex grid
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/hex_life/sketch.js"
          >
            hex life
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/météo²/sketch.js"
          >
            météo²
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/Molnár - squares/sketch.js"
          >
            molnár - squares
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/mosaic/sketch.js"
          >
            mosaics
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/onde/sketch.js"
          >
            onde
          </p>
          <p
            class="artwork"
            data-artist="Luchino Allix-Lastrego"
            data-path="art/LuchinoAllix/spread/sketch.js"
          >
            spread
          </p>
          <p
            class="artwork"
            data-artist="Taha Skiredj"
            data-path="art/Sorensorel/lines-genuary/sketch.js"
          >
            lines
          </p>
          <p
            class="artwork"
            data-artist="Taha Skiredj"
            data-path="art/Sorensorel/lines-genuary-v2/sketch.js"
          >
            lines 2
          </p>
          <!-- <p
            class="artwork"
            data-path="art/Sorensorel/Project2-l-system/cooltruc.js"
          >
            cooltruc - Sorensorel
          </p>  -->
          <p
            class="artwork"
            data-artist="Yogya Tulip Gamage"
            data-path="art/Yogya/glass/glass-bw.js"
          >
            glass
          </p>
          <p
            class="artwork"
            data-artist="Yogya Tulip Gamage"
            data-path="art/Yogya/rug/rug.js"
          >
            rug
          </p>
          <p
            class="artwork"
            data-artist="Yogya Tulip Gamage"
            data-path="art/Yogya/theo/theo.js"
          >
            theo
          </p>
        </div>
      </div>
      <script>
        const container = document.getElementById("artist-container");
        const artworks = Array.from(container.querySelectorAll(".artwork"));

        for (let i = artworks.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [artworks[i], artworks[j]] = [artworks[j], artworks[i]];
        }

        container.innerHTML = "";
        artworks.forEach((el) => container.appendChild(el));
      </script>

      <script>
        let codeAffiche = false;
        let currentP5Instance = null;
        let currentSketchPath = null;
        let artistName = null;
        const artworkContainer = document.getElementById("artwork-container");
        const artistNameContainer = document.getElementById(
          "artist-name-container"
        );

        document.getElementById("code-button").addEventListener("click", () => {
          if (!currentSketchPath) {
            alert("Aucune œuvre sélectionnée !");
            return;
          }

          if (!codeAffiche) {
            fetch(currentSketchPath)
              .then((res) => res.text())
              .then((code) => {
                if (currentP5Instance) {
                  currentP5Instance.remove();
                  currentP5Instance = null;
                }
                artworkContainer.innerHTML = `<pre><code>${code}</code></pre>`;
                codeAffiche = true;
                document.getElementById("button-icon").src =
                  "assets/svg/art.svg";
              });
          } else {
            artworkContainer.innerHTML = "";

            const oldScript = document.getElementById("dynamic-script");
            if (oldScript) oldScript.remove();

            const script = document.createElement("script");
            script.src = currentSketchPath;
            script.id = "dynamic-script";
            script.onload = () => {
              if (typeof sketch === "function") {
                currentP5Instance = new p5(sketch, artworkContainer);
              }
              codeAffiche = false;
              document.getElementById("button-icon").src =
                "assets/svg/code.svg";
            };
            document.body.appendChild(script);
          }
        });

        document.querySelectorAll(".artwork").forEach((el) => {
          el.addEventListener("mouseover", () => {
            const path = el.dataset.path;
            currentSketchPath = path;
            artistName = el.dataset.artist;
            artistNameContainer.textContent = artistName;

            if (artistName == null) {
              artistName = el.dataset.artist;
              cartelContainer.append(artistName);
            }

            if (codeAffiche) return;

            if (currentP5Instance) {
              currentP5Instance.remove();
              currentP5Instance = null;
            }

            const oldScript = document.getElementById("dynamic-script");
            if (oldScript) oldScript.remove();

            const script = document.createElement("script");
            script.src = path;
            script.id = "dynamic-script";
            script.type = "text/javascript";

            script.onload = () => {
              if (typeof sketch === "function") {
                currentP5Instance = new p5(sketch, artworkContainer);
              } else {
                console.error(
                  "Le fichier ne contient pas de fonction 'sketch'"
                );
              }
            };

            document.body.appendChild(script);
          });
        });
      </script>

      <!-- <script>
        document.getElementById("code-button").addEventListener("click", () => {
          fetch("art/UnMoutonPerdu/clouds/sketch.js")
            .then((response) => response.text())
            .then((data) => {
              let div = document.getElementById("artwork-container"); 
              div.innerHTML = ""; 
              div.innerHTML += `<pre><code>${data}</code></pre>`; 
            })
            .catch((error) => console.error("Error fetching code:", error));
        });
        </script> -->
    </main>
    <!-- <footer>
      <p>Footer</p>
    </footer> -->
  </body>
</html>
