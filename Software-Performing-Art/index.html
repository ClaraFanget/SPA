<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Software Performing Art</title>
    <link rel="stylesheet" href="css/style.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.3/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/addons/p5.sound.min.js"></script>
  </head>
  <body>
    <header>
      <h1 id="SPA-title">Software</h1>
      <h1 id="SPA-title">Performing</h1>
      <h1 id="SPA-title">Art</h1>
    </header>
    <main>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="pages/publications.html">Publications</a></li>
          <li><a href="pages/art-history.html">Art History</a></li>
          <li><a href="pages/contact.html">Contact</a></li>
          <li><a href="convert/html/test.html">Pandoc</a></li>
        </ul>
      </nav>
      <div id="art-container">
        <div id="artwork-container"></div>
        <div id="artist-container">
          <p class="artwork" data-path="art/UnMoutonPerdu/clouds/sketch.js">
            clouds - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/cubes/sketch.js">
            cubes - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/physarum/sketch.js">
            physarum - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/trees/sketch2.js">
            trees - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/tunnel/sketch.js">
            tunnels - Un Mouton Perdu
          </p>
          <p
            class="artwork"
            data-path="art/UnMoutonPerdu/colors-and-shapes/sketch.js"
          >
            colors and shape - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/deJong/sketch.js">
            deJong - Un Mouton Perdu
          </p>
          <p
            class="artwork"
            data-path="art/UnMoutonPerdu/ink-mountains/sketch.js"
          >
            ink mountains - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/labyrinth/sketch.js">
            labyrinth - Un Mouton Perdu
          </p>
          <p
            class="artwork"
            data-path="art/UnMoutonPerdu/random-walker/sketch.js"
          >
            random walker - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/squares001/sketch.js">
            squares001 - Un Mouton Perdu
          </p>
          <p
            class="artwork"
            data-path="art/UnMoutonPerdu/vera-molnar-tp/sketch.js"
          >
            vera-molnar - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/UnMoutonPerdu/wind/sketch.js">
            wind - Un Mouton Perdu
          </p>
          <p class="artwork" data-path="art/Nadia/4_flow_field_with_letters.js">
            flow field with letters - Nadia
          </p>
          <p
            class="artwork"
            data-path="art/CestJeanEnGros/Mind Duplication/sketch3.js"
          >
            NOT WORKING mind duplication - Cest Jean En Gros
          </p>
          <p
            class="artwork"
            data-path="art/CestJeanEnGros/Singularity/sketch6.js"
          >
            singularity - Cest Jean En Gros
          </p>
        </div>
      </div>

      <script>
        let currentP5Instance = null;

        document.querySelectorAll(".artwork").forEach((el) => {
          el.addEventListener("mouseover", () => {
            const path = el.dataset.path;

            if (currentP5Instance) {
              currentP5Instance.remove();
              currentP5Instance = null;
            }

            const oldScript = document.getElementById("dynamic-script");
            if (oldScript) {
              oldScript.remove();
            }

            const script = document.createElement("script");
            script.src = path;
            script.id = "dynamic-script";
            script.type = "text/javascript";

            script.onload = () => {
              if (typeof sketch === "function") {
                currentP5Instance = new p5(
                  sketch,
                  document.getElementById("artwork-container")
                );
              } else {
                console.error(
                  "Le fichier charg√© ne contient pas de fonction 'sketch'"
                );
              }
            };

            document.body.appendChild(script);
          });
        });
      </script>
    </main>
    <footer>
      <p>Footer</p>
    </footer>
  </body>
</html>
